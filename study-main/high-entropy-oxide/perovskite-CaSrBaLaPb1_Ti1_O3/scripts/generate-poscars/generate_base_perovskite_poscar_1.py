"""
generate_perevskite_poscar.py

ペロブスカイト構造のPOSCARファイルを生成するスクリプト

- 金属原子と酸素原子の座標を生成し、POSCARファイルを保存する
- 金属原子間の組み合わせを取得し、CSVファイルに書き込む

Ca0.2 Sr0.2 Ba0.2 La0.2 Pb0.2 Ti1 O3
1.0
       11.7381000519         0.0000000000         0.0000000000
        0.0000000000        11.7381000519         0.0000000000
        0.0000000000         0.0000000000        11.73800519
   Ca  Sr  Ba  La  Pb  Ti    O
   5   5   5   6   6   27   81

"""

import os
import random

# 出力先ディレクトリ
DIRECTORY_PATH = "/Users/tomomamo/Kyushu_University/tujikenn/study/high-entropy-oxide/perovskite-CaSrBaLaPb1_Ti1_O3/POSCARs/base"
FILE_NAME = "POSCAR"
# ディレクトリが存在しない場合は作成
if not os.path.exists(DIRECTORY_PATH):
    os.makedirs(DIRECTORY_PATH)

# 生成する構造の数
num_structures = 10

# Znの数(固定の金属)
# num_zinc = 5←？？？

# 初めの行から追加する行までのテキスト
initial_text = """Ca0.2 Sr0.2 Ba0.2 La0.2 Pb0.2 Ti1 O3
1.0
       11.7381000519         0.0000000000         0.0000000000
        0.0000000000        11.7381000519         0.0000000000
        0.0000000000         0.0000000000        11.73800519
   Ca  Sr  Ba  La  Pb  Ti    O
   5   5   5   6   6   27   81
Direct"""

# 変化させる座標
coords_random = [
    "0.000000000         0.000000000         0.000000000",
    "0.333333333         0.000000000         0.000000000",
    "0.666666667         0.000000000         0.000000000",
    "0.000000000         0.333333333         0.000000000",
    "0.333333333         0.333333333         0.000000000",
    "0.666666667         0.333333333         0.000000000",
    "0.000000000         0.666666667         0.000000000",
    "0.333333333         0.666666667         0.000000000",
    "0.666666667         0.666666667         0.000000000",
    "0.000000000         0.000000000         0.333333333",
    "0.333333333         0.000000000         0.333333333",
    "0.666666667         0.000000000         0.333333333",
    "0.000000000         0.333333333         0.333333333",
    "0.333333333         0.333333333         0.333333333",
    "0.666666667         0.333333333         0.333333333",
    "0.000000000         0.666666667         0.333333333",
    "0.333333333         0.666666667         0.333333333",
    "0.666666667         0.666666667         0.333333333",
    "0.000000000         0.000000000         0.666666667",
    "0.333333333         0.000000000         0.666666667",
    "0.666666667         0.000000000         0.666666667",
    "0.000000000         0.333333333         0.666666667",
    "0.333333333         0.333333333         0.666666667",
    "0.666666667         0.333333333         0.666666667",
    "0.000000000         0.666666667         0.666666667",
    "0.333333333         0.666666667         0.666666667",
    "0.666666667         0.666666667         0.666666667",
]
# 固定座標(Ti)
coords_Ti = """
0.166666667         0.166666667         0.166666667
0.500000000         0.166666667         0.166666667
0.833333333         0.166666667         0.166666667
0.166666667         0.500000000         0.166666667
0.500000000         0.500000000         0.166666667
0.833333333         0.500000000         0.166666667
0.166666667         0.833333333         0.166666667
0.500000000         0.833333333         0.166666667
0.833333333         0.833333333         0.166666667
0.166666667         0.166666667         0.500000000
0.500000000         0.166666667         0.500000000
0.833333333         0.166666667         0.500000000
0.166666667         0.500000000         0.500000000
0.500000000         0.500000000         0.500000000
0.833333333         0.500000000         0.500000000
0.166666667         0.833333333         0.500000000
0.500000000         0.833333333         0.500000000
0.833333333         0.833333333         0.500000000
0.166666667         0.166666667         0.833333333
0.500000000         0.166666667         0.833333333
0.833333333         0.166666667         0.833333333
0.166666667         0.500000000         0.833333333
0.500000000         0.500000000         0.833333333
0.833333333         0.500000000         0.833333333
0.166666667         0.833333333         0.833333333
0.500000000         0.833333333         0.833333333
0.833333333         0.833333333         0.833333333
"""

# 固定座標(酸素)
coords_Oxi = """
0.166666667         0.000000000         0.166666667
0.166666667         0.166666667         0.000000000
0.000000000         0.166666667         0.166666667
0.500000000         0.000000000         0.166666667
0.500000000         0.166666667         0.000000000
0.333333333         0.166666667         0.166666667
0.833333333         0.000000000         0.166666667
0.833333333         0.166666667         0.000000000
0.666666667         0.166666667         0.166666667
0.166666667         0.333333333         0.166666667
0.166666667         0.500000000         0.000000000
0.000000000         0.500000000         0.166666667
0.500000000         0.333333333         0.166666667
0.500000000         0.500000000         0.000000000
0.333333333         0.500000000         0.166666667
0.833333333         0.333333333         0.166666667
0.833333333         0.500000000         0.000000000
0.666666667         0.500000000         0.166666667
0.166666667         0.666666667         0.166666667
0.166666667         0.833333333         0.000000000
0.000000000         0.833333333         0.166666667
0.500000000         0.666666667         0.166666667
0.500000000         0.833333333         0.000000000
0.333333333         0.833333333         0.166666667
0.833333333         0.666666667         0.166666667
0.833333333         0.833333333         0.000000000
0.666666667         0.833333333         0.166666667
0.166666667         0.000000000         0.500000000
0.166666667         0.166666667         0.333333333
0.000000000         0.166666667         0.500000000
0.500000000         0.000000000         0.500000000
0.500000000         0.166666667         0.333333333
0.333333333         0.166666667         0.500000000
0.833333333         0.000000000         0.500000000
0.833333333         0.166666667         0.333333333
0.666666667         0.166666667         0.500000000
0.166666667         0.333333333         0.500000000
0.166666667         0.500000000         0.333333333
0.000000000         0.500000000         0.500000000
0.500000000         0.333333333         0.500000000
0.500000000         0.500000000         0.333333333
0.333333333         0.500000000         0.500000000
0.833333333         0.333333333         0.500000000
0.833333333         0.500000000         0.333333333
0.666666667         0.500000000         0.500000000
0.166666667         0.666666667         0.500000000
0.166666667         0.833333333         0.333333333
0.000000000         0.833333333         0.500000000
0.500000000         0.666666667         0.500000000
0.500000000         0.833333333         0.333333333
0.333333333         0.833333333         0.500000000
0.833333333         0.666666667         0.500000000
0.833333333         0.833333333         0.333333333
0.666666667         0.833333333         0.500000000
0.166666667         0.000000000         0.833333333
0.166666667         0.166666667         0.666666667
0.000000000         0.166666667         0.833333333
0.500000000         0.000000000         0.833333333
0.500000000         0.166666667         0.666666667
0.333333333         0.166666667         0.833333333
0.833333333         0.000000000         0.833333333
0.833333333         0.166666667         0.666666667
0.666666667         0.166666667         0.833333333
0.166666667         0.333333333         0.833333333
0.166666667         0.500000000         0.666666667
0.000000000         0.500000000         0.833333333
0.500000000         0.333333333         0.833333333
0.500000000         0.500000000         0.666666667
0.333333333         0.500000000         0.833333333
0.833333333         0.333333333         0.833333333
0.833333333         0.500000000         0.666666667
0.666666667         0.500000000         0.833333333
0.166666667         0.666666667         0.833333333
0.166666667         0.833333333         0.666666667
0.000000000         0.833333333         0.833333333
0.500000000         0.666666667         0.833333333
0.500000000         0.833333333         0.666666667
0.333333333         0.833333333         0.833333333
0.833333333         0.666666667         0.833333333
0.833333333         0.833333333         0.666666667
0.666666667         0.833333333         0.833333333"""

# 指定された数だけ構造を生成して出力
for id in range(1, num_structures + 1):
    # 出力ファイルのパスと名称設定
    output_file_path = os.path.join(DIRECTORY_PATH, f"{FILE_NAME}_{id}")

    # 生成したファイルを開き、書き込む
    with open(output_file_path, "w") as output_file:
        # 初めの構造条件の部分を書き込み＋改行
        output_file.write(initial_text + "\n")

        # 変数部分をランダムに並び替えて書き込み
        random.shuffle(coords_random)
        # 各行に改行を加える
        for line in coords_random:
            output_file.write(line + "\n")

        # 固定部分を書き込み
        # 「\n」(1個目)を使ってリスト内の要素を繋ぎ合わせる
        # 「\n」(2個目)を境にstrを区切ってリスト化する
        output_file.write("\n".join(coords_Ti.split("\n")[1:]))
        output_file.write("\n".join(coords_Oxi.split("\n")[1:]))
